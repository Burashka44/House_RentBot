# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –ø–æ–∏—Å–∫–∞ –†–°–û

## –û–±–∑–æ—Ä

–í HouseBot —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç—Ä–∏ –ø–æ–¥—Ö–æ–¥–∞ –∫ –ø–æ–ª—É—á–µ–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö –æ –†–°–û (—Ä–µ—Å—É—Ä—Å–æ—Å–Ω–∞–±–∂–∞—é—â–∏—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è—Ö):

### ‚úÖ A. DaData API (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–§–∞–π–ª:** `bot/services/dadata_service.py`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ –ø—Ä–∏ –≤–≤–æ–¥–µ
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥—Ä–µ—Å–æ–≤ (–§–ò–ê–°)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–± –£–ö (—É–ø—Ä–∞–≤–ª—è—é—â–µ–π –∫–æ–º–ø–∞–Ω–∏–∏)
- ‚úÖ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –ø–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å
- ‚úÖ 10,000 –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from bot.services.dadata_service import get_dadata_service

dadata = get_dadata_service()
house_info = await dadata.get_house_info("–ú–æ—Å–∫–≤–∞ –õ–µ–Ω–∏–Ω–∞ 5")

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
{
    'address': '–≥ –ú–æ—Å–∫–≤–∞, —É–ª –õ–µ–Ω–∏–Ω–∞, –¥ 5',
    'fias_id': 'abc123...',
    'management_company': '–û–û–û –£–ö –ú–æ–π –î–æ–º',
    'coords': {'lat': '55.751', 'lon': '37.618'},
    ...
}
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://dadata.ru
2. –ü–æ–ª—É—á–∏—Ç–µ API-–∫–ª—é—á (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
3. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```
DADATA_API_KEY=your_key_here
DADATA_SECRET_KEY=your_key_here  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è clean API
```

---

### üöß C. –ü–∞—Ä—Å–µ—Ä –ì–ò–° –ñ–ö–• (–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ)
**–°—Ç–∞—Ç—É—Å:** –®–∞–±–ª–æ–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞  
**–§–∞–π–ª:** `bot/services/gis_parser_service.py`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ü–æ–∏—Å–∫ –¥–æ–º–∞ –ø–æ FIAS ID
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –†–°–û —Å —Å–∞–π—Ç–∞ dom.gosuslugi.ru –∏–ª–∏ reformagkh.ru
- –ü–∞—Ä—Å–∏–Ω–≥ –ø—É–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∞—Ç—å ToS —Å–∞–π—Ç–æ–≤
- ‚ö†Ô∏è HTML —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è CAPTCHA-solving –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
- ‚ö†Ô∏è –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

**–î–ª—è –¥–æ—Ä–∞–±–æ—Ç–∫–∏:**
1. –í—Ä—É—á–Ω—É—é –∏–∑—É—á–∏—Ç—å HTML-—Å—Ç—Ä—É–∫—Ç—É—Ä—É dom.gosuslugi.ru
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å CSS-—Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –†–°–û
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ö–æ–¥ CAPTCHA (–µ—Å–ª–∏ –µ—Å—Ç—å)
4. –î–æ–±–∞–≤–∏—Ç—å rate limiting –∏ retry –ª–æ–≥–∏–∫—É
5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∞–¥—Ä–µ—Å–∞—Ö

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ):**
```python
from bot.services.gis_parser_service import ReformaGKHParser

parser = ReformaGKHParser()
house = await parser.search_house(
    region="–ú–æ—Å–∫–≤–∞",
    city="–ú–æ—Å–∫–≤–∞", 
    street="—É–ª. –õ–µ–Ω–∏–Ω–∞",
    house="5"
)

if house:
    uk = house['uk']  # {'name': '...', 'inn': '...'}
    rso_list = house['rso_list']  
    # [{'name': '–ú–æ—Å—ç–Ω–µ—Ä–≥–æ', 'service': '–≠–ª–µ–∫—Ç—Ä–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ'}, ...]
```

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π Workflow

### –í–∞—Ä–∏–∞–Ω—Ç 1: DaData + –†—É—á–Ω–æ–π –≤–≤–æ–¥ –†–°–û (–ù–∞–¥–µ–∂–Ω–æ)
1. –ê–¥–º–∏–Ω –≤–≤–æ–¥–∏—Ç –∞–¥—Ä–µ—Å
2. DaData –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã
3. –ê–¥–º–∏–Ω –≤—ã–±–∏—Ä–∞–µ—Ç –∞–¥—Ä–µ—Å
4. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –£–ö –∏–∑ DaData
5. **–ê–¥–º–∏–Ω –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–ª—è–µ—Ç –†–°–û** —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –±–æ—Ç–∞
6. –õ–∏—Ü–µ–≤—ã–µ —Å—á–µ—Ç–∞ –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ –æ–±—ä–µ–∫—Ç–∞–º

**–ü–ª—é—Å—ã:**
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ
- ‚úÖ –õ–µ–≥–∞–ª—å–Ω–æ
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å

**–ú–∏–Ω—É—Å—ã:**
- ‚è± –¢—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –†–°–û

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: DaData + –ü–∞—Ä—Å–µ—Ä –ì–ò–° (–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ)
1. –ê–¥–º–∏–Ω –≤–≤–æ–¥–∏—Ç –∞–¥—Ä–µ—Å
2. DaData –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç, –ø–æ–ª—É—á–∞–µ—Ç FIAS ID –∏ –£–ö
3. **–ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –†–°–û** –∏–∑ –ì–ò–° –ñ–ö–•
4. –ê–¥–º–∏–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü–æ—á—Ç–∏ –ø–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- ‚úÖ –ë—ã—Å—Ç—Ä–æ

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø–∞—Ä—Å–µ—Ä–∞
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º
- ‚ö†Ô∏è –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –¢–æ–ª—å–∫–æ DaData (–ü—Ä–æ—Å—Ç–æ–π)
1. –ê–¥–º–∏–Ω –≤–≤–æ–¥–∏—Ç –∞–¥—Ä–µ—Å
2. DaData –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç, –ø–æ–ª—É—á–∞–µ—Ç –£–ö
3. **–†–°–û –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**
4. –ê–¥–º–∏–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç –†–°–û –≤—Ä—É—á–Ω—É—é –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ
- ‚úÖ –õ–µ–≥–∞–ª—å–Ω–æ
- ‚úÖ –ù–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ú–∏–Ω—É—Å—ã:**
- ‚è± –†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –¥–ª—è –†–°–û

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–ª—è Production (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å DADATA_API_KEY –≤ `.env`
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `normalize_address_enhanced()` –≤–º–µ—Å—Ç–æ `normalize_address()`
3. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å UI –¥–ª—è –≤—ã–±–æ—Ä–∞ –∞–¥—Ä–µ—Å–∞ –∏–∑ —Å–∞–¥–∂–µ—Å—Ç–æ–≤ (—Å–º. `dadata_examples.py`)
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –†–°–û –≤—Ä—É—á–Ω—É—é

### –î–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —Å –ø–∞—Ä—Å–µ—Ä–æ–º:
1. üîç –ò–∑—É—á–∏—Ç—å HTML-—Å—Ç—Ä—É–∫—Ç—É—Ä—É reformagkh.ru (–ø—Ä–æ—â–µ —á–µ–º –ì–ò–° –ñ–ö–•)
2. üõ† –î–æ–ø–∏—Å–∞—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ `ReformaGKHParser._parse_house_page()`
3. üß™ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 5-10 –∞–¥—Ä–µ—Å–∞—Ö
4. ‚öñÔ∏è –û—Ü–µ–Ω–∏—Ç—å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

### –î–ª—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ API –ì–ò–° –ñ–ö–•:
1. üìù –ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –∞–∫–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏—é (–¥–æ–ª–≥–æ)
2. üìú –ü–æ–ª—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
3. üíª –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å SOAP API (—Å–ª–æ–∂–Ω–æ)

---

## FAQ

**Q: –ù—É–∂–µ–Ω –ª–∏ –ø–∞—Ä—Å–µ—Ä, –µ—Å–ª–∏ –µ—Å—Ç—å DaData?**  
A: –ù–µ—Ç, –µ—Å–ª–∏ –≤—ã –≥–æ—Ç–æ–≤—ã –¥–æ–±–∞–≤–ª—è—Ç—å –†–°–û –≤—Ä—É—á–Ω—É—é. DaData –¥–∞–µ—Ç –∞–¥—Ä–µ—Å –∏ –£–ö, –Ω–æ –Ω–µ –†–°–û.

**Q: –ó–∞–∫–æ–Ω–Ω–æ –ª–∏ –ø–∞—Ä—Å–∏—Ç—å –ì–ò–° –ñ–ö–•?**  
A: –°–ø–æ—Ä–Ω—ã–π –≤–æ–ø—Ä–æ—Å. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ - –Ω–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ API. –ü–∞—Ä—Å–∏–Ω–≥ –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∞—Ç—å ToS. –î–ª—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ª—É—á—à–µ –ø–æ–ª—É—á–∏—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø.

**Q: –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç DaData?**  
A: –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å. –ü–æ—Ç–æ–º –æ—Ç 1‚ÇΩ –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –ø–æ–ª—É—á–∏—Ç—å –†–°–û –∏–∑ DaData?**  
A: –ù–µ—Ç, DaData –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –†–°–û. –¢–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –£–ö.
